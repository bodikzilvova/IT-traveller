const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GreetingView-DCXgv8pw.js","assets/IButton-nJx-Yn-X.js","assets/vue-router-CYCvQ7zy.js","assets/@vue-Dd7PfzIL.js","assets/BaseLayout-Dumg3ZM2.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/HomepageView-DFVyp-YB.js","assets/useMutation-BK_m-cCX.js","assets/@studiometa-faEmcXEZ.js","assets/mapbox-gl-C3szAys-.js","assets/@mapbox-DkKJftln.js","assets/base-64-pjGhQ_mO.js","assets/suggestions-BWbTs_cj.js","assets/xtend-CeaPpq3n.js","assets/fuzzy-BKApOM0A.js","assets/lodash.debounce-BDooTpFg.js","assets/events-CXH2uRM3.js","assets/eventemitter3-6E4L_h32.js","assets/is-plain-obj-BUzXRDLz.js","assets/nanoid-CLXzqmDa.js","assets/subtag-CDP2nEeg.js","assets/mapbox-gl-B6a97v0r.css","assets/pinia-qQrRtHZ7.js","assets/axios-BimPEqV4.js","assets/AuthView-D5RcFeWg.js","assets/LoginView-vYAZfYW3.js","assets/RegistrationView-AHpI8hHV.js"])))=>i.map(i=>d[i]);
var E=t=>{throw TypeError(t)};var P=(t,e,r)=>e.has(t)||E("Cannot "+r);var g=(t,e,r)=>(P(t,e,"read from private field"),r?r.call(t):e.get(t)),v=(t,e,r)=>e.has(t)?E("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),f=(t,e,r,s)=>(P(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r);import{b,i as I,g as O,A as R}from"./@vue-Dd7PfzIL.js";import{c as S}from"./pinia-qQrRtHZ7.js";import{c as V,a as B,R as C}from"./vue-router-CYCvQ7zy.js";import{a as D}from"./axios-BimPEqV4.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();const U="modulepreload",$=function(t){return"/IT-traveller/"+t},T={},p=function(e,r,s){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));o=Promise.all(r.map(a=>{if(a=$(a),a in T)return;T[a]=!0;const d=a.endsWith(".css"),k=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${k}`))return;const c=document.createElement("link");if(c.rel=d?"stylesheet":U,d||(c.as="script"),c.crossOrigin="",c.href=a,i&&c.setAttribute("nonce",i),document.head.appendChild(c),d)return new Promise((w,A)=>{c.addEventListener("load",w),c.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${a}`)))})}))}return o.then(()=>e()).catch(n=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n})},l=D.create({baseURL:"https://back-for-vue.b.goit.study/"}),h="token";var u;class K{constructor(){v(this,u,null)}isLoggedIn(){return!!g(this,u)}getToken(){return g(this,u)}setToken(e){localStorage.setItem(h,e),f(this,u,e)}clearToken(){f(this,u,null),localStorage.removeItem(h)}async login(e){const{data:r}=await l.post("/user/login",e),{accessToken:s}=r;this.setToken(s)}async registerUser(e){const{data:r}=await l.post("/user/register",e),{accessToken:s}=r;this.setToken(s)}async logout(){await l.get("/user/logout"),this.clearToken()}async refresh(){const{data:e}=await l.get("/user/refresh"),{accessToken:r}=e;this.setToken(r)}}u=new WeakMap;const m=new K;l.interceptors.request.use(t=>{const e=m.getToken();return e&&(t.headers={...t.headers,Authorization:`Bearer ${e}`}),t});l.interceptors.response.use(t=>t,async t=>{if(t.response.status===401)try{return await m.refresh()}catch(r){return _.push("/auth/login"),Promise.reject(r)}return Promise.reject(t)});const N=()=>p(()=>import("./GreetingView-DCXgv8pw.js"),__vite__mapDeps([0,1,2,3,4,5])),j=()=>p(()=>import("./HomepageView-DFVyp-YB.js"),__vite__mapDeps([6,3,1,2,7,5,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])),q=()=>p(()=>import("./AuthView-D5RcFeWg.js"),__vite__mapDeps([24,2,3,4,5])),F=()=>p(()=>import("./LoginView-vYAZfYW3.js"),__vite__mapDeps([25,3,7,1,2,22,23])),H=()=>p(()=>import("./RegistrationView-AHpI8hHV.js"),__vite__mapDeps([26,3,1,2,7,22,23])),W=[{path:"/",component:N,name:"greeting"},{path:"/map",component:j,name:"homepage"},{path:"/auth",component:q,redirect:"/auth/login",children:[{path:"login",component:F,name:"login"},{path:"registration",component:H,name:"registration"}]}],_=V({history:B(),routes:W});_.beforeEach((t,e,r)=>{const s=["login","registration"],{name:o}=t;m.isLoggedIn()&&s.includes(o)?r({name:"homepage"}):!s.includes(o)&&!m.isLoggedIn()?r({name:"login"}):r()});const x={__name:"App",setup(t){return(e,r)=>(b(),I(O(C)))}},L=localStorage.getItem(h);L&&m.setToken(L);const y=R(x);y.use(S());y.use(_);y.mount("#app");export{m as a,l as c,_ as r};
